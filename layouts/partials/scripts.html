<!-- Alpine.js for interactive components -->
<script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

<!-- Theme switcher -->
<script>
    // Get the site's color scheme preference from config
    const siteColorScheme = "{{ .Site.Params.colorScheme }}";
    
    // Check if dark mode should be enabled
    if (localStorage.theme === 'dark' || 
        (localStorage.theme === undefined && 
         siteColorScheme === 'dark' || 
         (siteColorScheme === 'system' && 
          window.matchMedia('(prefers-color-scheme: dark)').matches))) {
        document.documentElement.classList.add('dark');
    } else {
        document.documentElement.classList.remove('dark');
    }
    
    // Set initial value for Alpine.js
    window.initialDarkMode = document.documentElement.classList.contains('dark');
</script>

<!-- Analytics placeholder -->
{{ with .Site.GoogleAnalytics }}
<script async src="https://www.googletagmanager.com/gtag/js?id={{ . }}"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ . }}');
</script>
{{ end }}